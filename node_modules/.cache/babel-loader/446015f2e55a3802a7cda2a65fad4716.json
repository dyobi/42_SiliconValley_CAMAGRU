{"ast":null,"code":"var _jsxFileName = \"/Users/dyobi/Desktop/camagru/src/components/body/camera/index.jsx\";\nimport React from 'react';\nimport Webcam from 'react-webcam';\nimport { IoIosRadioButtonOn, IoMdSend } from \"react-icons/io\";\nimport { FiFilm } from \"react-icons/fi\";\nimport { confirmAlert } from 'react-confirm-alert';\nimport { FiUpload } from 'react-icons/fi';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { cam_arr, cam_curr, cam_filter, ui_nav, acc_user, acc_signin, cam_patch } from '../../../actions';\nimport './index.css';\nimport axios from 'axios';\n\nfunction BodyCam() {\n  const webcamRef = React.useRef(null);\n  const dispatch = useDispatch();\n  let cam = useSelector(state => state.cam);\n  let acc = useSelector(state => state.acc);\n  let absoluteX = 0;\n  let absoluteY = 0;\n\n  function Capture() {\n    if (cam.arr === undefined) {\n      dispatch(cam_arr(webcamRef.current.getScreenshot()));\n    } else {\n      dispatch(cam_arr(cam.arr.concat(webcamRef.current.getScreenshot())));\n    }\n  }\n\n  ;\n\n  function Temporary(cam, i) {\n    let status = cam.curr;\n\n    if (status === -1) {\n      dispatch(cam_curr(i));\n    } else if (status === i) {\n      dispatch(cam_curr(-1));\n      dispatch(cam_patch([]));\n    } else {\n      dispatch(cam_curr(i));\n      dispatch(cam_patch([]));\n    }\n  }\n\n  function Filter() {\n    dispatch(cam_filter(cam.filter + 1));\n\n    if (cam.filter === 2) {\n      dispatch(cam_filter(-1));\n    }\n  }\n\n  function SetFil() {\n    if (cam.filter === 0) {\n      return \"body-cam-fil1\";\n    } else if (cam.filter === 1) {\n      return \"body-cam-fil2\";\n    } else if (cam.filter === 2) {\n      return \"body-cam-fil3\";\n    }\n  }\n\n  function Submit() {\n    if (acc.user === '') {\n      alert('Log in first !');\n      dispatch(ui_nav(3));\n    } else if (cam.arr.length === 0) {\n      alert('Take pictures first !');\n    } else if (cam.curr === -1) {\n      alert('Choose one picture !');\n    } else {\n      let stickers = [];\n\n      for (let i = 0; i < cam.patch.length; i++) {\n        let target = document.getElementById('stickers-' + i);\n        stickers.push({\n          name: cam.patch[i],\n          x: parseInt(target.style.left) / parseInt(document.getElementById('preview').offsetWidth),\n          y: parseInt(target.style.top) / parseInt(document.getElementById('preview').offsetWidth)\n        });\n      }\n\n      axios.post('/submit', {\n        explain: document.getElementById('comment').textContent,\n        user: acc.user,\n        pic: cam.arr[cam.curr],\n        filter: cam.filter,\n        sticker: stickers\n      }).then(res => {\n        document.getElementById('comment').textContent = '';\n\n        if (res.data !== 11) {\n          alert('Successfully posted !');\n          dispatch(cam_arr([]));\n          dispatch(cam_curr(-1));\n          dispatch(cam_patch([]));\n        } else {\n          alert('Session is expired !');\n          dispatch(ui_nav(3));\n          dispatch(acc_user(''));\n          dispatch(acc_signin(0));\n        }\n      });\n    }\n  }\n\n  const _handleFileUpload = () => {\n    let input = document.getElementById('file');\n    let extension = input.value.split('.')[input.value.split('.').length - 1];\n\n    if (extension === 'jpg' || extension === 'jpeg' || extension === 'png') {\n      let file = input.files[0];\n      let reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = () => {\n        dispatch(cam_arr(cam.arr.concat(reader.result)));\n      };\n    } else {\n      input.value = '';\n      confirmAlert({\n        message: 'Extension of image can be only .jpg, .jpeg, .png!',\n        buttons: [{\n          label: 'Okay'\n        }]\n      });\n    }\n  };\n\n  function _handleSticker(e) {\n    dispatch(cam_patch(cam.patch.concat(e)));\n  }\n\n  function _handleDrag(e) {\n    absoluteX = !absoluteX ? e.clientX : absoluteX;\n    absoluteY = !absoluteY ? e.clientY + document.getElementById('camera').scrollTop : absoluteY;\n    e.target.style.left = e.clientX - absoluteX + 'px';\n    e.target.style.top = e.clientY - absoluteY + document.getElementById('camera').scrollTop + 'px';\n  }\n\n  document.addEventListener(\"dragover\", function (event) {\n    event.preventDefault();\n  }, false);\n\n  function _delSticker() {\n    dispatch(cam_patch([]));\n  }\n\n  return React.createElement(\"div\", {\n    id: \"camera\",\n    className: \"body-cam\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"body-cam-part\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    id: \"preview\",\n    className: \"body-cam-contain\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, cam.curr === -1 ? React.createElement(Webcam, {\n    className: \"body-cam-camera\",\n    ref: webcamRef,\n    screenshotFormat: \"image/jpeg\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }) : '', cam.curr !== -1 ? React.createElement(\"div\", {\n    className: \"body-cam-camera-s\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, cam.patch.map((p, u) => React.createElement(\"div\", {\n    id: 'stickers-' + u,\n    className: \"sticker-patch\",\n    draggable: \"true\",\n    onDrag: _handleDrag,\n    onDoubleClick: () => _delSticker(),\n    style: {\n      backgroundImage: 'url(\\'/stickers/' + p + '\\')'\n    },\n    key: u,\n    alt: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }))) : '', cam.curr !== -1 && cam.filter === -1 ? React.createElement(\"img\", {\n    className: \"body-cam-camera\",\n    src: cam.arr[cam.curr],\n    alt: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }) : '', cam.curr !== -1 && cam.filter !== -1 ? React.createElement(\"img\", {\n    className: \"\".concat(SetFil(), \" body-cam-camera\"),\n    src: cam.arr[cam.curr],\n    alt: \"\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }) : '', cam.curr !== -1 ? React.createElement(FiFilm, {\n    className: \"body-cam-filter\",\n    onClick: () => Filter(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }) : '', React.createElement(FiUpload, {\n    className: \"file\",\n    onClick: () => document.getElementById('file').click(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }), React.createElement(\"input\", {\n    id: \"file\",\n    type: \"file\",\n    onChange: () => _handleFileUpload(),\n    style: {\n      display: 'none'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }), React.createElement(IoIosRadioButtonOn, {\n    className: \"body-cam-shot\",\n    onClick: () => {\n      cam.curr === -1 ? Capture() : dispatch(cam_curr(-1));\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"body-cam-preview\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, cam.arr.map((pic, i) => React.createElement(\"img\", {\n    className: i === cam.curr ? \"\".concat(SetFil(), \" body-cam-pre-one-action\") : \"body-cam-pre-one\",\n    key: i,\n    src: pic,\n    alt: \"\",\n    onClick: () => Temporary(cam, i),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }))), cam.curr !== -1 ? React.createElement(\"div\", {\n    className: \"sticker-container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, cam.sticker.map((cont, idx) => React.createElement(\"div\", {\n    className: \"sticker-array\",\n    style: {\n      backgroundImage: 'url(\\'/stickers/' + cont + '\\')'\n    },\n    key: idx,\n    alt: \"\",\n    onClick: () => _handleSticker(cont),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }))) : '', React.createElement(\"div\", {\n    type: \"text\",\n    className: \"body-cam-comment\",\n    contentEditable: \"true\",\n    id: \"comment\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }), React.createElement(IoMdSend, {\n    className: \"body-cam-choose\",\n    onClick: () => Submit(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  })));\n}\n\nexport default BodyCam;","map":{"version":3,"sources":["/Users/dyobi/Desktop/camagru/src/components/body/camera/index.jsx"],"names":["React","Webcam","IoIosRadioButtonOn","IoMdSend","FiFilm","confirmAlert","FiUpload","useDispatch","useSelector","cam_arr","cam_curr","cam_filter","ui_nav","acc_user","acc_signin","cam_patch","axios","BodyCam","webcamRef","useRef","dispatch","cam","state","acc","absoluteX","absoluteY","Capture","arr","undefined","current","getScreenshot","concat","Temporary","i","status","curr","Filter","filter","SetFil","Submit","user","alert","length","stickers","patch","target","document","getElementById","push","name","x","parseInt","style","left","offsetWidth","y","top","post","explain","textContent","pic","sticker","then","res","data","_handleFileUpload","input","extension","value","split","file","files","reader","FileReader","readAsDataURL","onload","result","message","buttons","label","_handleSticker","e","_handleDrag","clientX","clientY","scrollTop","addEventListener","event","preventDefault","_delSticker","map","p","u","backgroundImage","click","display","cont","idx"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Webcam from 'react-webcam';\nimport { IoIosRadioButtonOn, IoMdSend } from \"react-icons/io\";\nimport { FiFilm } from \"react-icons/fi\";\nimport { confirmAlert } from 'react-confirm-alert';\nimport { FiUpload } from 'react-icons/fi';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { cam_arr, cam_curr, cam_filter, ui_nav, acc_user, acc_signin, cam_patch } from '../../../actions';\nimport './index.css';\n\nimport axios from 'axios';\n\nfunction BodyCam () {\n    const webcamRef = React.useRef(null);\n    const dispatch = useDispatch();\n    let cam = useSelector(state => state.cam);\n    let acc = useSelector(state => state.acc);\n    let absoluteX = 0;\n\tlet absoluteY = 0;\n\n    function Capture() {\n        if (cam.arr === undefined) {\n            dispatch(cam_arr(webcamRef.current.getScreenshot()));\n        } else {\n            dispatch(cam_arr(cam.arr.concat(webcamRef.current.getScreenshot())));\n        }\n    };\n\n    function Temporary(cam, i) {\n        let status = cam.curr;\n\n        if (status === -1) {\n            dispatch(cam_curr(i));\n        } else if (status === i) {\n            dispatch(cam_curr(-1));\n            dispatch(cam_patch([]));\n        } else {\n            dispatch(cam_curr(i));\n            dispatch(cam_patch([]));\n        }\n    }\n\n    function Filter() {\n        dispatch(cam_filter(cam.filter + 1))\n        if (cam.filter === 2) {\n            dispatch(cam_filter(-1));\n        }\n    }\n\n    function SetFil() {\n        if (cam.filter === 0) {\n            return (\"body-cam-fil1\");\n        } else if (cam.filter === 1) {\n            return (\"body-cam-fil2\");\n        } else if (cam.filter === 2) {\n            return (\"body-cam-fil3\");\n        }\n    }\n\n    function Submit() {\n        if (acc.user === '') {\n            alert('Log in first !');\n            dispatch(ui_nav(3));\n        }\n        else if (cam.arr.length === 0) {\n            alert('Take pictures first !');\n        }\n        else if (cam.curr === -1) {\n            alert('Choose one picture !');\n        }\n        else {\n            let stickers = [];\n\t\t\tfor(let i = 0; i < cam.patch.length; i++) {\n\t\t\t\tlet target = document.getElementById('stickers-' + i);\n\t\t\t\tstickers.push({\n\t\t\t\t\tname: cam.patch[i],\n\t\t\t\t\tx: parseInt(target.style.left) / parseInt(document.getElementById('preview').offsetWidth),\n\t\t\t\t\ty: parseInt(target.style.top) / parseInt(document.getElementById('preview').offsetWidth)\n\t\t\t\t});\n            }\n            axios.post('/submit', {\n                explain: document.getElementById('comment').textContent,\n                user: acc.user,\n                pic: cam.arr[cam.curr],\n                filter: cam.filter,\n                sticker: stickers\n            })\n            .then(res => {\n                document.getElementById('comment').textContent = '';\n                if (res.data !== 11) {\n                    alert('Successfully posted !');\n                    dispatch(cam_arr([]));\n                    dispatch(cam_curr(-1));\n                    dispatch(cam_patch([]));\n                } else {\n                    alert('Session is expired !');\n                    dispatch(ui_nav(3));\n                    dispatch(acc_user(''));\n                    dispatch(acc_signin(0));\n                }\n            })\n        }\n    }\n\n    const _handleFileUpload = () => {\n\t\tlet input = document.getElementById('file');\n\t\tlet extension = input.value.split('.')[input.value.split('.').length - 1];\n\t\tif(extension === 'jpg' || extension === 'jpeg' || extension === 'png') {\n\t\t\tlet file = input.files[0];\n\t\t\tlet reader = new FileReader();\n\t\t\treader.readAsDataURL(file);\n\t\t\treader.onload = () => {\n                dispatch(cam_arr(cam.arr.concat(reader.result)));\n\t\t\t}\n\t\t} else {\n\t\t\tinput.value = '';\n\t\t\tconfirmAlert({\n\t\t\t\tmessage: 'Extension of image can be only .jpg, .jpeg, .png!',\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Okay'\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n    }\n    \n    function _handleSticker(e) {\n        dispatch(cam_patch(cam.patch.concat(e)));\n    }\n\n    function _handleDrag(e) {\n        absoluteX = !absoluteX ? e.clientX : absoluteX;\n\t\tabsoluteY = !absoluteY ? e.clientY + document.getElementById('camera').scrollTop : absoluteY;\n\t\te.target.style.left = e.clientX - absoluteX + 'px';\n\t\te.target.style.top = e.clientY - absoluteY + document.getElementById('camera').scrollTop + 'px';\n    }\n\n    document.addEventListener(\"dragover\", function(event) {\n\t\tevent.preventDefault();\n    }, false);\n    \n    function _delSticker() {\n        dispatch(cam_patch([]));\n    }\n\n    return (\n        <div id=\"camera\" className=\"body-cam\">\n            <div className=\"body-cam-part\">\n                <div id=\"preview\" className=\"body-cam-contain\">\n                    {cam.curr === -1 ? <Webcam className=\"body-cam-camera\" ref={webcamRef} screenshotFormat='image/jpeg' /> : ''}\n                    {cam.curr !== -1 ? \n                        <div className=\"body-cam-camera-s\">\n                            {cam.patch.map((p, u) => <div id={'stickers-' + u} className=\"sticker-patch\" draggable=\"true\" onDrag={_handleDrag} onDoubleClick={() => _delSticker()} style={{backgroundImage: 'url(\\'/stickers/' + p + '\\')'}} key={u} alt=\"\" />)}\n                        </div>\n                     : '' }\n                    {cam.curr !== -1 && cam.filter === -1 ? <img className=\"body-cam-camera\" src={cam.arr[cam.curr]} alt=\"\" /> : ''}\n                    {cam.curr !== -1 && cam.filter !== -1 ? <img className={`${SetFil()} body-cam-camera`} src={cam.arr[cam.curr]} alt=\"\" /> : ''}\n                    {cam.curr !== -1 ? <FiFilm className=\"body-cam-filter\" onClick={() => Filter()}/> : '' }\n                    <FiUpload className='file' onClick={ () => document.getElementById('file').click() } />\t\n\t\t\t\t\t<input id='file' type='file' onChange={ () => _handleFileUpload() } style={{ display: 'none'}}></input>\n                    <IoIosRadioButtonOn className=\"body-cam-shot\" onClick={() => {cam.curr === -1 ? Capture() : dispatch(cam_curr(-1))}} />\n                </div>\n                <div className=\"body-cam-preview\">\n                {cam.arr.map((pic, i) => <img className={i === cam.curr ? `${SetFil()} body-cam-pre-one-action` : \"body-cam-pre-one\"} \n                key={i} src={pic} alt=\"\" onClick={() => Temporary(cam, i)} />)}\n                </div>\n                {cam.curr !== -1 ? \n                    <div className=\"sticker-container\">\n                        {cam.sticker.map((cont, idx) => <div className=\"sticker-array\" style={{backgroundImage: 'url(\\'/stickers/' + cont + '\\')'}} key={idx} alt=\"\" \n                        onClick={() => _handleSticker(cont)} />)}\n                    </div>\n                 : ''}\n                <div type=\"text\" className=\"body-cam-comment\" contentEditable=\"true\" id=\"comment\" />\n                <IoMdSend className=\"body-cam-choose\" onClick={() => Submit()}/>\n            </div>\n        </div>\n    );\n}\n\nexport default BodyCam;"]},"metadata":{},"sourceType":"module"}